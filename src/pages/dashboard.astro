---
import Footer from '../components/Footer.astro';
import documentsData from '../data/documents_2.json';

const documents = documentsData.results;
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Dashboard - BioSeekers NASA</title>
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;500;600;700;800;900&family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="/styles/tailwind.css">
		<link rel="stylesheet" href="/styles/typography.css">
		<link rel="stylesheet" href="/styles/animations.css">
		<link rel="stylesheet" href="/styles/space-effects.css">
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	</head>
	<body class="space-container text-white overflow-x-hidden min-h-screen overflow-y-auto">
		<!-- Mobile Hamburger Menu -->
		<div class="lg:hidden bg-[#1a1a2e] border-b border-[#333] py-2 px-4 flex justify-end">
			<button id="mobileMenuToggle" class="text-white p-1 bg-[#333] rounded hover:bg-[#444] transition-colors">
				<svg width="20" height="20" viewBox="0 0 24 24" fill="none">
					<path d="M3 12H21M3 6H21M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				</svg>
			</button>
		</div>
		
		<div class="flex min-h-screen">
			<!-- Left Sidebar -->
			<div id="sidebar" class="w-64 bg-[#1a1a2e] border-r border-[#333] flex flex-col hidden lg:flex fixed lg:relative top-0 left-0 h-screen lg:h-auto lg:min-h-screen z-50">
				<!-- Logo -->
				<div class="p-6 border-b border-[#333] flex items-center justify-between">
					<img src="/images/logo_landing.png" alt="BioSeekers Logo" class="h-6 w-auto" />
					<button id="closeSidebar" class="lg:hidden text-white">
						<svg width="24" height="24" viewBox="0 0 24 24" fill="none">
							<path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					</button>
				</div>
				<!-- Navigation Menu -->
				<nav class="flex-1 p-4 space-y-2">
					<div class="space-y-1">
						<a href="/search" class="flex items-center gap-3 text-white hover:text-[#FFE500] cursor-pointer">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M21 21L16.514 16.506L21 21ZM19 10.5C19 15.194 15.194 19 10.5 19C5.806 19 2 15.194 2 10.5C2 5.806 5.806 2 10.5 2C15.194 2 19 5.806 19 10.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
							<span>Search</span>
						</a>
						<a href="/documents" class="flex items-center gap-3 text-white hover:text-[#FFE500] cursor-pointer">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M14 2H6C4.895 2 4 2.895 4 4V20C4 21.105 4.895 22 6 22H18C19.105 22 20 21.105 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
								<path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
								<path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
								<path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
								<path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
							<span>Documents</span>
						</a>
						<div class="flex items-center gap-3 text-[#FFE500] cursor-pointer border-l-2 border-[#FFE500] pl-3">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<path d="M3 3H21V21H3V3ZM5 5V19H19V5H5ZM7 7H17V9H7V7ZM7 11H17V13H7V11ZM7 15H17V17H7V15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
							<span>Dashboard</span>
						</div>
						<a href="/qa" class="flex items-center gap-3 text-white hover:text-[#FFE500] cursor-pointer">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none">
								<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
								<path d="M9.09 9C9.325 8.331 9.789 7.812 10.4 7.4C11.011 6.988 11.73 6.8 12.5 6.8C13.27 6.8 13.989 6.988 14.6 7.4C15.211 7.812 15.675 8.331 15.91 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
								<path d="M12 17H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
							</svg>
							<span>Q & A</span>
						</a>
					</div>
				</nav>
				<!-- User Profile -->
				<div class="p-4 border-t border-[#333]">
					<div class="flex items-center gap-3">
						<div class="w-8 h-8 bg-gradient-to-br from-[#FFE500] to-[#FFA500] rounded-full flex items-center justify-center">
							<span class="text-black font-bold text-sm">U</span>
						</div>
						<div>
							<div class="text-white text-sm font-medium">User Profile</div>
							<div class="text-gray-400 text-xs">Scientist</div>
						</div>
					</div>
				</div>
			</div>
			
			<!-- Main Content -->
			<div class="flex-1 bg-[#0a0a1a] relative">
				<!-- Background Elements -->
				<div class="absolute inset-0 bg-stars animate-twinkle opacity-30"></div>
				<div class="absolute bottom-0 left-0 w-full h-[40%] bg-grid-pattern animate-grid-move opacity-20"></div>
				<!-- Content -->
				<div class="relative z-10 p-4 sm:p-6 lg:p-8">
					<!-- Header -->
					<div class="mb-6 lg:mb-8">
						<h1 class="space-title text-[#FFE500] mb-4 text-xl lg:text-2xl">Research Analytics Dashboard</h1>
						<p class="space-body text-gray-300 text-sm lg:text-base">Comprehensive insights into NASA's bioscience research data</p>
					</div>
					
					<!-- Stats Overview -->
					<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
						<div class="bg-[#1a1a2e] border border-[#333] rounded-lg p-4">
							<div class="flex items-center justify-between">
								<div>
									<p class="text-gray-400 text-sm">Total Documents</p>
									<p class="text-2xl font-bold text-white">{documents.length}</p>
								</div>
								<div class="w-12 h-12 bg-[#FFE500]/10 rounded-lg flex items-center justify-center">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none">
										<path d="M14 2H6C4.895 2 4 2.895 4 4V20C4 21.105 4.895 22 6 22H18C19.105 22 20 21.105 20 20V8L14 2Z" stroke="#FFE500" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
									</svg>
								</div>
							</div>
						</div>
						
						<div class="bg-[#1a1a2e] border border-[#333] rounded-lg p-4">
							<div class="flex items-center justify-between">
								<div>
									<p class="text-gray-400 text-sm">Avg Score</p>
									<p class="text-2xl font-bold text-white">{Math.round(documents.reduce((sum, doc) => sum + doc.score, 0) / documents.length * 100)}%</p>
								</div>
								<div class="w-12 h-12 bg-[#00d4ff]/10 rounded-lg flex items-center justify-center">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none">
										<path d="M9 19C9 19.5304 9.21071 20.0391 9.58579 20.4142C9.96086 20.7893 10.4696 21 11 21H13C13.5304 21 14.0391 20.7893 14.4142 20.4142C14.7893 20.0391 15 19.5304 15 19V5C15 4.46957 14.7893 3.96086 14.4142 3.58579C14.0391 3.21071 13.5304 3 13 3H11C10.4696 3 9.96086 3.21071 9.58579 3.58579C9.21071 3.96086 9 4.46957 9 5V19Z" stroke="#00d4ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
									</svg>
								</div>
							</div>
						</div>
						
						<div class="bg-[#1a1a2e] border border-[#333] rounded-lg p-4">
							<div class="flex items-center justify-between">
								<div>
									<p class="text-gray-400 text-sm">Research Areas</p>
									<p class="text-2xl font-bold text-white">6</p>
								</div>
								<div class="w-12 h-12 bg-[#4ade80]/10 rounded-lg flex items-center justify-center">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none">
										<circle cx="12" cy="12" r="10" stroke="#4ade80" stroke-width="2"/>
										<path d="M8 12L10.5 14.5L16 9" stroke="#4ade80" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
									</svg>
								</div>
							</div>
						</div>
						
						<div class="bg-[#1a1a2e] border border-[#333] rounded-lg p-4">
							<div class="flex items-center justify-between">
								<div>
									<p class="text-gray-400 text-sm">High Score Docs</p>
									<p class="text-2xl font-bold text-white">{documents.filter(doc => doc.score > 0.6).length}</p>
								</div>
								<div class="w-12 h-12 bg-[#f59e0b]/10 rounded-lg flex items-center justify-center">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none">
										<path d="M12 2L15.09 8.26L22 9L17 14L18.18 21L12 17.77L5.82 21L7 14L2 9L8.91 8.26L12 2Z" stroke="#f59e0b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
									</svg>
								</div>
							</div>
						</div>
					</div>
					
					<!-- Charts Section -->
					<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
						<!-- Score Distribution Chart -->
						<div class="bg-[#1a1a2e] border border-[#333] rounded-lg p-6">
							<h3 class="text-lg font-semibold text-white mb-4">Score Distribution</h3>
							<div class="h-64">
								<canvas id="scoreChart"></canvas>
							</div>
						</div>
						
						<!-- Research Areas Pie Chart -->
						<div class="bg-[#1a1a2e] border border-[#333] rounded-lg p-6">
							<h3 class="text-lg font-semibold text-white mb-4">Research Areas</h3>
							<div class="h-64">
								<canvas id="areasChart"></canvas>
							</div>
						</div>
					</div>
					
					<!-- Additional Charts -->
					<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
						<!-- Score Trend Chart -->
						<div class="bg-[#1a1a2e] border border-[#333] rounded-lg p-6">
							<h3 class="text-lg font-semibold text-white mb-4">Score Trends</h3>
							<div class="h-64">
								<canvas id="trendChart"></canvas>
							</div>
						</div>
						
						<!-- Document Types Chart -->
						<div class="bg-[#1a1a2e] border border-[#333] rounded-lg p-6">
							<h3 class="text-lg font-semibold text-white mb-4">Document Types</h3>
							<div class="h-64">
								<canvas id="typesChart"></canvas>
							</div>
						</div>
					</div>
					
					<!-- Top Documents Table -->
					<div class="bg-[#1a1a2e] border border-[#333] rounded-lg p-6">
						<h3 class="text-lg font-semibold text-white mb-4">Top Performing Documents</h3>
						<div class="overflow-x-auto">
							<table class="w-full text-sm">
								<thead>
									<tr class="border-b border-[#333]">
										<th class="text-left py-3 text-gray-400">Title</th>
										<th class="text-left py-3 text-gray-400">Score</th>
										<th class="text-left py-3 text-gray-400">Type</th>
										<th class="text-left py-3 text-gray-400">Status</th>
									</tr>
								</thead>
								<tbody>
									{documents
										.sort((a, b) => b.score - a.score)
										.slice(0, 5)
										.map((doc, index) => (
											<tr class="border-b border-[#333]/50 hover:bg-[#1a1a2e]/50">
												<td class="py-3 text-white">
													<div class="max-w-xs truncate" title={doc.title}>
														{doc.title}
													</div>
												</td>
												<td class="py-3">
													<span class="text-[#FFE500] font-medium">
														{(doc.score * 100).toFixed(1)}%
													</span>
												</td>
												<td class="py-3 text-gray-400">{doc.chunk_type}</td>
												<td class="py-3">
													<span class="px-2 py-1 rounded text-xs bg-[#4ade80]/10 text-[#4ade80]">
														Active
													</span>
												</td>
											</tr>
										))}
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- Footer -->
		<Footer />
		
		<script src="/js/dashboard.js" is:inline></script>
	</body>
</html>
